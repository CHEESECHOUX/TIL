# 성능 최적화

<details>
    <summary><h2>응답 시간과 처리량</h2></summary>
    <strong>네트워크 속도, 디스크 속도, 메모리 크기, 디바이스(스마트폰)의 CPU 속도</strong> 등이 성능과 관련되어 있다.<br>
    <strong>서버 성능과 관련 있는 중요한 지표</strong>를 2가지 꼽자면 <strong>응답 시간과 처리량</strong><br>
    <br>
    <h2>1. 응답 시간</h2>
    <h3>응답 시간 = 사용자의 요청을 처리하는 데 걸리는 시간</h3>
    <p>서버는 로직을 실행한 다음, 응답 데이터를 클라이언트에 전송한다.<br>
    응답 데이터를 전송할 때는 API 요청 과정에서 서버와 연결된 소켓을 이용한다.</p>
    <br>
    <ul>
        <li><strong>TTFB (Time to First Byte):</strong> 응답 데이터 중 <strong>첫 번째 바이트가 도착</strong>할 때까지 걸린 시간</li>
        <li><strong>TTLB (Time to Last Byte):</strong> 응답 데이터의 <strong>마지막 바이트가 도착</strong>할 때 걸린 시간</li>
    </ul>
    <p>응답 데이터의 크기가 작다면 TTFB와 TTLB의 차이가 크지 않다. 하지만 파일 다운로드처럼 전송할 데이터가 크거나 네트워크 속도가 느리면 TTFB와 TTLB의 차이가 커질 수 있다. 
    <strong>데이터 특성이나 네트워크 환경을 고려해 TTFB와 TTLB중 적절한 지표를 선택</strong>해 측정해야 한다.</p> 
    <br>
    <p>응답 시간은 1초보다 짧을 때가 많아, 성능 측정을 위해 1/1000초인 밀리초(ms) 단위를 사용한다.</p>
    <br>
    <h3>응답 시간의 구성</h3>
    <ul>
        <li>API 요청 전송 시간</li>
        <li>서버의 처리 시간</li>
        <li>API 응답 전송 시간</li>
    </ul>
    <p>서버 개발자는 주로 <strong>서버의 처리 시간</strong>을 확인한다.</p>
    <br>
    <h3>서버 처리 시간 구성 요소</h3>
    <ul>
        <li>로직 수행 (if, for 등)</li>
        <li>DB 연동</li>
        <li>외부 API 연동</li>
        <li>응답 데이터 생성 (전송)</li>
    </ul>
    ⭐️ 이 중에서도 <strong>DB 연동</strong>과 <strong>외부 API 연동</strong> 시간이 처리 시간의 대부분을 차지하므로, <strong>응답 시간을 줄이기 위해서는 이 두 부분을 집중적으로 최적화</strong>해야 한다.<br>
    <br><br>
    <h2>2. 처리량</h2>
    <h3>처리량 = 단위 시간당 시스템이 처리하는 작업량</h3>
    <br>
    ⭐️ TPS는 <strong>시스템이 처리할 수 있는 최대 요청 수</strong>를 의미</p>
    <ul>
        <li><strong>TPS (transactions per second):</strong> 초당 트랜잭션 수</li>
        <li><strong>RPS (requests per second):</strong> 초당 요청 수</li>
    </ul>
    <br>
    <p>ex) 서버가 한 번에 5개의 요청을 처리할 수 있다고 가정하면,<br>
    이때 요청당 처리 시간이 1초라면 최대 TPS는 5<br><br>동시에 들어오는 요청 수가 최대 TPS를 초과하면 초과한 요청을 나중에 처리한다.<br>
    <br>
    동시에 7개의 요청이 들어오면 나중에 처리된 2개의 요청 시간은 응답 시간이 2초가 된다.<br>
    (기다리는 시간 1초 + 실제 처리한 시간 1초)</p>
    <br><br>
    <p><strong>요청이 최대 TPS를 초과하면 응답 시간이 지연</strong>된다. 
    응답 시간의 증가는 사용자 이탈로 이어질 수 있다.</p><br>
    <h3>💡 사용자 이탈을 막기 위해 TPS를 높이려면?</h3>
    <ul>
        <li><strong>동시에 처리할 수 있는 요청 수를 늘려</strong> 대기 시간 줄이기</li>
        <li><strong>처리 시간 자체를 줄여</strong> 대기 시간 줄이기</li>
    </ul>
    <br>
    <p><strong>트래픽이 많은 시간대의 TPS와 응답 시간이 얼마인지 측정</strong>하고, 이를 바탕으로 <strong>목표 TPS와 응답 시간을 설정</strong>하고 효과적인 <strong>성능 개선안을 도출</strong>해야 한다.</p>
    <br>
    <p>* TPS를 확인하는 가장 간단한 방법<br>
    모니터링 시스템 (ex: 스카우터, 핀포인트, 뉴렐릭)</p>
    <br>
</details>
